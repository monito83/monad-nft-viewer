<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Proyectos NFT Monad</title>
  <style>
    body { font-family: 'Segoe UI', sans-serif; background: #f0f0f0; margin: 0; padding: 0; color: #333; }
    header { background: #4c51bf; color: white; text-align: center; padding: 1.5rem 1rem; }
    header h1 { margin: 0; font-size: 1.8rem; }
    header .header-buttons { margin-top: 0.5rem; }
    .header-buttons button { background: transparent; border: none; color: white; font-size: 1rem; margin: 0 0.5rem; cursor: pointer; }
    .header-buttons button:hover { text-decoration: underline; }
    .filters { display: flex; gap: 1rem; flex-wrap: wrap; justify-content: center; padding: 1rem; }
    .filters input, .filters select { padding: 0.5rem; font-size: 1rem; border: 1px solid #ccc; border-radius: 6px; }
    main { max-width: 1200px; margin: auto; padding: 1rem; }
    .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px,1fr)); gap: 1.5rem; }
    .card { background: white; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      padding: 1rem; display: flex; flex-direction: column; align-items: center; gap: .5rem;
      border-left: 6px solid transparent; transition: transform 0.2s ease; }
    .card:hover { transform: scale(1.02); cursor: pointer; }
    .tier-1 { border-left-color: green; }
    .tier-2 { border-left-color: yellowgreen; }
    .tier-3 { border-left-color: orange; }
    .tier-4 { border-left-color: orangered; }
    .tier-5 { border-left-color: red; }
    .tier-default { border-left-color: #a0aec0; }
    .card h3 { margin: 0; color: #4c51bf; font-size: 1.2rem; text-align: center; }
    .tag, .tier-badge { display: inline-block; padding: 0.4rem 0.8rem; border-radius: 6px;
      color: white; font-size: 1rem; margin: 0.2rem; font-weight: bold; }
    .Abierto { background: #38a169; }
    .Cerrado { background: #e53e3e; }
    .Pendiente, .Desconocido, .Otro { background: #718096; }
    .tier-badge { background: #805ad5; }
    .tier-1-badge { background: green; }
    .tier-2-badge { background: yellowgreen; }
    .tier-3-badge { background: orange; }
    .tier-4-badge { background: orangered; }
    .tier-5-badge { background: red; }
    .logo { width: 60px; height: 60px; border-radius: 50%; object-fit: cover; margin-bottom: .5rem; }
    .buy-button { background: #4299e1; color: white; border: none; border-radius: 6px; padding: .4rem .8rem;
      cursor: pointer; font-size: .9rem; margin-top: .5rem; font-weight: bold; text-decoration: none; }
    .buy-button:hover { background: #3182ce; }
    .modal { position: fixed; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.5);
      display:none; align-items:center; justify-content:center; padding:1rem; }
    .modal-content { background:white; padding:2rem; border-radius:12px; max-width:600px; width:100%;
      max-height:90vh; overflow-y:auto; position:relative; }
    .modal-close { position:absolute; top:10px; right:20px; font-size:1.8rem; cursor:pointer; color:#333; }
    .info-section { border:1px solid #ddd; border-radius:8px; margin-top:1rem; padding:1rem; }
    .info-section h3 { margin:0 0 .5rem; font-size:1.1rem; }
    .info-section p { margin:.3rem 0; white-space: pre-line; }
    footer { text-align:center; padding:1rem; font-size:.85rem; color:#666; }
  </style>
</head>
<body>
  <header>
    <h1>Proyectos NFT en Monad</h1>
    <div class="header-buttons">
      <button id="faqBtn">üìò FAQ</button>
    </div>
    <p>Actualizado: <span id="fecha"></span></p>
  </header>
  <div class="filters">
    <input id="projectFilter" placeholder="Buscar proyecto‚Ä¶" />
    <select id="tierFilter"><option value="">Todos los Tiers</option></select>
    <select id="estadoFilter"><option value="">Todos los Estados</option></select>
  </div>
  <main><div id="cardGrid" class="grid"></div></main>

  <!-- Detalles del proyecto -->
  <div id="modal" class="modal">
    <div class="modal-content">
      <span class="modal-close" onclick="modal.style.display='none'">&times;</span>
      <div id="modalDetails"></div>
    </div>
  </div>

  <!-- Modal FAQ -->
  <div id="faqModal" class="modal">
    <div class="modal-content">
      <span class="modal-close" onclick="faqModal.style.display='none'">&times;</span>
      <h2>üìò FAQ</h2>
      <div id="faqContent"></div>
    </div>
  </div>

  <footer>üîß Generado desde Google Sheets</footer>

  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
  <script>
    const SHEET_CSV = 'https://docs.google.com/spreadsheets/d/1lG1Xzzzs4jNKII6deHT_PtY6ltGPp2RAlr7_ak-wRZ4/export?format=csv';
    const cardGrid = document.getElementById('cardGrid');
    const projectFilter = document.getElementById('projectFilter');
    const tierFilter = document.getElementById('tierFilter');
    const estadoFilter = document.getElementById('estadoFilter');
    const modal = document.getElementById('modal');
    const modalDetails = document.getElementById('modalDetails');
    const faqModal = document.getElementById('faqModal');
    const faqContent = document.getElementById('faqContent');
    const faqBtn = document.getElementById('faqBtn');
    let allData = [];

    function getTierBadgeClass(t) {
      if (!t) return 'tier-default-badge';
      const num = parseInt(t);
      return num>=1 && num<=5 ? `tier-${num}-badge` : 'tier-default-badge';
    }

    function showModal(i) {
      const row = allData[i];
      const estado = row['Estado Testnet']||'Desconocido';
      const estadoClass = /abierto/i.test(estado)?'Abierto'
        :/cerrado/i.test(estado)?'Cerrado'
        :/pendiente/i.test(estado)?'Pendiente':'Otro';
      modal.style.display = 'flex';
      modalDetails.innerHTML = `
        ${row['Logo']?`<img src="${row['Logo']}" class="logo">`:''}
        <h2>${row['Proyecto']}</h2>
        <div class="tag ${estadoClass}">${estado}</div>
        <div class="tier-badge ${getTierBadgeClass(row['Tier'])}">üèÖ Tier ${row['Tier']}</div>

        <div class="info-section"><h3>‚úÖ Pase WL Directo</h3>
          <p>${row['Pase WL Directo']||''}</p>
          <p><strong>Beneficio:</strong> ${row['Beneficio WL Directo']||''}</p>
          <p><strong>Floor:</strong> ${row['Floor Price Pase Directo (MON)']||''} MON</p>
          ${row['Link Pase Directo']?`<a href="${row['Link Pase Directo']}" target="_blank" class="buy-button">Comprar Pase</a>`:''}
        </div>

        <div class="info-section"><h3>üì¶ NFT Acumulativo</h3>
          <p>${row['NFT Acumulativo']||''}</p>
          <p><strong>Beneficios:</strong> ${row['Beneficios Acumulativos']||''}</p>
          <p><strong>Floor:</strong> ${row['Floor Price NFT Acumulativo (MON)']||''} MON</p>
          ${row['Link NFT Acumulativo']?`<a href="${row['Link NFT Acumulativo']}" target="_blank" class="buy-button">Comprar NFT</a>`:''}
        </div>

        <div class="info-section"><h3>üß† Roles WL</h3>
          <p>${row['Roles WL']||''}</p>
        </div>

        <div class="info-section"><h3>üìé Notas</h3>
          <p>${row['Notas']||''}</p>
        </div>
      `;
    }

    function openFAQFromSheet(text) {
      faqContent.innerText = text || 'Sin FAQ configurada';
      faqModal.style.display = 'flex';
    }

    function renderCards(data) {
      cardGrid.innerHTML = '';
      data.forEach((row,i) => {
        const estado = row['Estado Testnet']||'Desconocido';
        const estadoClass = /abierto/i.test(estado)?'Abierto'
          :/cerrado/i.test(estado)?'Cerrado'
          :/pendiente/i.test(estado)?'Pendiente':'Otro';
        const badgeClass = getTierBadgeClass(row['Tier']);
        const card = document.createElement('div');
        card.className = `card tier-${row['Tier']||'default'}`;
        card.onclick = () => showModal(i);
        card.innerHTML = `
          ${row['Logo']?`<img src="${row['Logo']}" class="logo">`:''}
          <h3>${row['Proyecto']}</h3>
          <div class="tag ${estadoClass}">${estado}</div>
          <div class="tier-badge ${badgeClass}">üèÖ Tier ${row['Tier']}</div>
        `;
        cardGrid.appendChild(card);
      });
    }

    function applyFilters() {
      const name = projectFilter.value.toLowerCase();
      const tf = tierFilter.value;
      const ef = estadoFilter.value;
      const filtered = allData.filter(r =>
        r['Proyecto'].toLowerCase().includes(name) &&
        (!tf || r['Tier'] === tf) &&
        (!ef || r['Estado Testnet'] === ef)
      );
      renderCards(filtered);
    }

    Papa.parse(SHEET_CSV, {
      download: true, header: true,
      complete: results => {
        allData = results.data.map(r => {
          const clean = {};
          for (const k in r) clean[k.trim()] = r[k];
          return clean;
        }).filter(r => r['Proyecto']);
        allData.forEach(row => { /* nada extra */ });
        [...new Set(allData.map(r=>r['Tier']).filter(Boolean))].forEach(v => {
          const o = document.createElement('option');
          o.value = v; o.textContent = v; tierFilter.appendChild(o);
        });
        [...new Set(allData.map(r=>r['Estado Testnet']).filter(Boolean))].forEach(v => {
          const o = document.createElement('option');
          o.value = v; o.textContent = v; estadoFilter.appendChild(o);
        });
        renderCards(allData);
        document.getElementById('fecha').textContent = new Date().toLocaleDateString('es-AR');
        // configurar FAQ desde la primera fila FAQ
        const faqText = allData[0] ? allData[0]['FAQ'] : '';
        faqBtn.onclick = () => openFAQFromSheet(faqText);
      }
    });

    projectFilter.addEventListener('input', applyFilters);
    tierFilter.addEventListener('change', applyFilters);
    estadoFilter.addEventListener('change', applyFilters);
    window.addEventListener('click', e => {
      if (e.target === modal) modal.style.display='none';
      if (e.target === faqModal) faqModal.style.display='none';
    });
  </script>
</body>
</html>
